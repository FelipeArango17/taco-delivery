<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Seleccionar Método de Pago</title>
    <link rel="stylesheet" th:href="@{/carrito.css}">
    <link rel="stylesheet" th:href="@{/footer.css}">
    <style>
        body {
            background: #f7b733;
            font-family: 'Poppins', sans-serif;
            margin: 0;
        }

        .contenedor {
            max-width: 600px;
            margin: 50px auto;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        h2 {
            text-align: center;
            color: #512da8;
        }

        .metodo {
            margin: 15px 0;
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 10px;
            cursor: pointer;
        }

        .metodo:hover {
            background: #f0f0f0;
        }

        .btn-confirmar {
            display: block;
            margin: 25px auto 0;
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 12px;
            width: 300px;
            text-align: center;
        }

        .close {
            float: right;
            font-size: 22px;
            cursor: pointer;
            color: #888;
        }
    </style>
</head>
<body>
<header>
    <h1>Seleccionar Método de Pago</h1>
    <a href="/menu/confirmar" class="btn-volver">⬅ Volver</a>
</header>

<div class="contenedor">
    <h2>Elige tu método de pago</h2>
    <form th:action="@{/pago/procesar}" method="post">
        <input type="hidden" name="total" th:value="${total}">

        <div class="metodo">
            <input type="radio" name="metodoPago" value="credito" id="credito" required>
            <label for="credito">Tarjeta de Crédito</label>
        </div>

        <div class="metodo">
            <input type="radio" name="metodoPago" value="debito" id="debito">
            <label for="debito">Tarjeta de Débito</label>
        </div>

        <div class="metodo">
            <input type="radio" name="metodoPago" value="efectivo" id="efectivo">
            <label for="efectivo">Pago contra entrega (efectivo)</label>
        </div>

        <input type="hidden" name="cuotas" id="cuotas">
        <button type="submit" class="btn-confirmar">Confirmar pago</button>
    </form>
</div>

<!-- Modal de cuotas -->
<div class="modal" id="modalCuotas">
    <div class="modal-content">
        <span class="close" onclick="cerrarModal()">&times;</span>
        <h3>Seleccione el número de cuotas</h3>
        <select id="selectCuotas">
            <option value="1">1 cuota</option>
            <option value="3">3 cuotas</option>
            <option value="6">6 cuotas</option>
            <option value="12">12 cuotas</option>
        </select>
        <br><br>
        <button onclick="aceptarCuotas()">Aceptar</button>
    </div>
</div>

<script>
    const credito = document.getElementById('credito');
    const modal = document.getElementById('modalCuotas');
    const cuotasInput = document.getElementById('cuotas');

    credito.addEventListener('change', () => {
        modal.style.display = 'block';
    });

    function cerrarModal() {
        modal.style.display = 'none';
        credito.checked = false;
    }

    function aceptarCuotas() {
        const seleccion = document.getElementById('selectCuotas').value;
        cuotasInput.value = seleccion;
        modal.style.display = 'none';
        alert('Pago con tarjeta de crédito a ' + seleccion + ' cuotas seleccionado.');
    }

    window.onclick = function(event) {
        if (event.target === modal) modal.style.display = 'none';
    }
</script>

<div th:replace="fragments/footer :: footer"></div>
</body>
</html>