<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Men칰 de Tacos</title>
    <link rel="stylesheet" th:href="@{/menu.css}">
    <link rel="stylesheet" th:href="@{/footer.css}">
</head>
<body>

<header>
    <div class="header-content">
        <h1>Nuestro Men칰</h1>

        <div class="header-buttons">
            <div class="perfil" id="perfilBtn">
                <img src="/static.images/user-iconv2.png" alt="Usuario">
            </div>

            <a href="/menu/carrito" class="btn-ver-carrito">游 Ver carrito</a>
        </div>
    </div>
</header>

<!-- Aviso si el usuario intenta agregar sin loguearse -->
<div th:if="${aviso}" class="aviso-login" style="margin: 15px 0;">
    <p th:text="${aviso}" style="color:red; font-weight:bold;"></p>
    <a href="/login" class="btn-login" style="display:inline-block; padding: 8px 12px; background-color:#007bff; color:white; text-decoration:none; border-radius:5px; margin-top:5px;">
        Ir a Login
    </a>
</div>

<div class="menu-container">
    <div class="taco-card" th:each="taco : ${tacos}">
        <img th:src="@{|/static.images/tacos-${#strings.replace(#strings.replace(#strings.replace(taco.nombre.toLowerCase(), 'tacos de ', ''), 'tacos al ', ''), ' ', '-')}.png|}"
             th:alt="'Taco ' + ${taco.nombre}" class="taco-img">

        <h2 th:text="${taco.nombre}"></h2>
        <p th:switch="${taco.nombre}">
            <span th:case="'Tacos al Pastor'">Deliciosos tacos con carne marinada y pi침a.</span>
            <span th:case="'Tacos de Carne Asada'">Cl치sicos con carne asada al carb칩n.</span>
            <span th:case="'Tacos de Pollo'">Jugosos tacos de pollo con especias.</span>
            <span th:case="'Tacos de Chorizo'">Exquisito Chorizo a la parrilla.</span>
            <span th:case="'Tacos de Pescado'">Suaves y deliciosos.</span>
            <span th:case="'Tacos de Veganos'">Saludables para tu forma de vida.</span>
            <span th:case="'Tacos de Barbacoa'">Barbacoa ba침ada en salsa que gustes.</span>
            <span th:case="'Tacos de Camaron'">Torrente de sabor.</span>
            <span th:case="'Tacos de Mixtos'">Lo que quieras en una sola orden.</span>
            <span th:case="'Tacos de Cochinita Pibil'">Jugosos y sabrosos, los mejores.</span>
        </p>

        <form th:action="@{/menu/agregar}" method="post">
            <input type="hidden" name="nombre" th:value="${taco.nombre}">
            <input type="hidden" name="tama침o" value="Normal">
            <button type="submit" class="btn-agregar">Agregar al carrito</button>
        </form>
    </div>
</div>

<!-- FOOTER -->
<footer>
    <div class="footer-container">
        <div class="footer-section">
            <h3>TacoDelivery</h3>
            <p>Los mejores tacos a un clic de distancia.</p>
        </div>

        <div class="footer-section">
            <h3>Contacto</h3>
            <p><i class="fa fa-envelope"></i> contacto@tacodelivery.com</p>
            <p><i class="fa fa-phone"></i> +57 300 123 4567</p>
        </div>

        <div class="footer-section">
            <h3>S칤guenos</h3>
            <div class="social-icons">
                <a href="#"><i class="fa fa-facebook-f"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        춸 2025 TacoDelivery - Todos los derechos reservados
    </div>
</footer>

<!-- MODAL din치mico seg칰n si hay sesi칩n o no -->
<div id="logoutModal" class="modal">
    <div class="modal-content">
        <!-- Si el usuario est치 logueado -->
        <div th:if="${session.usuario != null}">
            <h3>쮻eseas cerrar sesi칩n?</h3>
            <div class="modal-buttons">
                <button id="cancelBtn">Cancelar</button>
                <button id="logoutBtn">Cerrar sesi칩n</button>
            </div>
        </div>

        <!-- Si NO est치 logueado -->
        <div th:if="${session.usuario == null}">
            <h3>No has iniciado sesi칩n</h3>
            <div class="modal-buttons">
                <button id="cancelBtns">Cancelar</button>
                <button id="loginBtn">Ir al login</button>
            </div>
        </div>
    </div>
</div>

<script>
    const perfilBtn = document.getElementById('perfilBtn');
    const logoutModal = document.getElementById('logoutModal');
    const cancelBtns = document.querySelectorAll('#cancelBtn, #cancelBtns');
    const logoutBtn = document.getElementById('logoutBtn');
    const loginBtn = document.getElementById('loginBtn');

    perfilBtn.addEventListener('click', () => {
        logoutModal.style.display = 'flex';
    });

    cancelBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            logoutModal.style.display = 'none';
        });
    });

    if (logoutBtn) {
        logoutBtn.addEventListener('click', () => {
            window.location.href = '/logout';
        });
    }

    if (loginBtn) {
        loginBtn.addEventListener('click', () => {
            window.location.href = '/login';
        });
    }

    window.addEventListener('click', (e) => {
        if (e.target === logoutModal) {
            logoutModal.style.display = 'none';
        }
    });
</script>

</body>
</html>
